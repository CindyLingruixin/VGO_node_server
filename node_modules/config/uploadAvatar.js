var models = require('config/models');
var fs = require('fs');

exports.uploadAvatar = function(sess, req, callback){

    var user_id = sess.user_id;

    /* temp disable
    if(!user_id){
        callback({
            "code": "-1",
            "msg": "Please login first"
        });
        return;
    }
    */
    
    models.User.findOne({_id: user_id}, function (err, doc) {

        console.log(req.body);
        /*
        console.log(req.files.image.originalFilename);
        console.log(req.files.image.path);
        fs.readFile(req.files.image.path, function (err, data){
            var path = require('path');
            var appDir = path.dirname(require.main.filename);
            var newPath = appDir + "/avatars/" +  user_id;
            fs.writeFile(newPath, data, function (err) {
                if(err){
                    callback({
                        "code": "-2",
                        "msg": "Avatar upload failed"
                    });
                }else {
                    // change db avatar flag
                    doc.has_avatar = 1;
                    callback({
                        "code": "1",
                        "msg": "Avatar uploaded successfully"
                    });
                }
            });
        });
        */
    });
}